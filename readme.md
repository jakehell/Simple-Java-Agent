Taken from https://www.jrebel.com/blog/how-write-javaagent

With bugfixes for creating non existing directories
